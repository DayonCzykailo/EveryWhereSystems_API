<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link th:href="@{/bootstrap-icons-1.9.1/bootstrap-icons.css}" rel="stylesheet" type="text/css">

    <link rel="stylesheet" th:href="@{/css/bootstrap/bootstrap.min.css}" type="text/css">
    <link rel="stylesheet" th:href="@{/css/menu.css}" type="text/css">

    <link rel="stylesheet" th:href="@{/css/script.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script th:src="@{/js/menu.js}" type="text/javascript"></script>

    <!-- Include Moment.js CDN -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js">
    </script>

    <!-- Include Bootstrap DateTimePicker CDN -->
    <link
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css"
        rel="stylesheet">

    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js">
        </script>

    <title id="Title">Docker</title>
</head>

<body id="body-pd">
    <div th:insert="components/menuTamplate :: menuTamplate(tela='docker')"></div>
    <form th:object="${docker}" action="#" th:action="@{/docker/save/{name}(name=${docker.name})}" method="post">
        <!--MENU-->
        <div class="mx-4" id="page-content-wrapper">
            <!--BODY da página-->
            <div class="row">

                <div class="col mt-4 py-2 pt-3 px-3  rounded-4 shadow lightMode">
                    <div class="row text-end">
                        <div class="col text-start">
                            <div th:switch="${name}">
                                <h3 th:case="null">Novo Container</h3>
                            </div>
                            <h3 id="title" th:text="*{name}">Nome do Container Docker</h2>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-primary" type="submit">Salvar</button>
                        </div>
                        <div class="col-auto">
                            <a class="btn btn-secondary" th:href="gerenciarDocker.html" role="button">Cancelar</a>
                        </div>
                        <div class="col-auto">
                            <div class="form-check">
                                <input checked="checked" class="form-check-input " type="checkbox" th:field="*{ativo}"
                                    id="ativoCheckBox">
                                <label class="form-check-label" for="ativoCheckBox">
                                    Ativo
                                </label>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col mt-4 py-2 pt-3 px-3  rounded-4 shadow lightMode">
                    <div class="row fullSize">
                        <div class="col fullSize">
                            <div class="row">
                                <div class="col">
                                    <h3 id="description">Descrição</h3>
                                </div>
                            </div>
                            <textarea th:field="*{description}" class="form-control textAreaSize lightMode mb-3"
                                rows="5" placeholder="Esse Script é em --- e acessa o --- para --- ..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">

                <div class="col mt-4 py-2 pt-3 px-3  rounded-4 shadow lightMode">
                    <div class="row fullSize">
                        <div class="col fullSize">
                            <h3 id="description">Configuração</h3>
                            <div class="mb-3">
                                <label for="nomeContainer" class="form-label">Nome</label>
                                <input type="text" class="form-control" id="nomeContainer" placeholder="Container">
                            </div>
                            <div class="mb-3">
                                <label for="imagemContainer" class="form-label">Imagem</label>
                                <input type="text" class="form-control" id="imagemContainer"
                                    placeholder="maven:3-amazoncorretto-19">
                            </div>
                            <!--<input class="form-control" type="file" id="formFile">-->
                        </div>
                    </div>
                </div>
            </div>

            <div class="row fullSize">
                <div class="col mt-4 py-2 pt-3 px-3  rounded-4 shadow lightMode">
                    <div class="row fullSize">
                        <div class="col fullSize">
                            <div class="row">
                                <div class="col">
                                    <h3 id="log">Log do Docker</h3>
                                </div>
                                <div class="col-auto">
                                    <button class="btn btn-primary" id="btnSave">Atualizar</button>
                                </div>
                            </div>
                            <textarea th:field="*{log}" disabled readonly class="form-control textAreaSize lightMode"
                                rows="12" placeholder="Log..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row fullSize">
                <div class="col mt-4 py-2 pt-3 px-3  rounded-4 shadow lightMode">
                    <div class="row fullSize">
                        <div class="col fullSize">
                            <div class="row">
                                <div class="col">
                                    <h3>Status do Container</h3>
                                    <input type="hidden" id="containerStatus" th:value="*{status}" />
                                </div>
                                <div class="col-auto">
                                    <button class="btn btn-primary" id="btnSave">Atualizar</button>
                                </div>
                            </div>
                            <div class="col fullSize">
                                <textarea disabled readonly rows="12" id="status"
                                    class="form-control textAreaSize lightMode" placeholder="Status..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <script>
            dados = []
            function processa() {
                var mensagem = $("#containerStatus").val();
                var name = $("#title").val();
                //console.log(mensagem)
                lines = mensagem.split('\n');
                console.log(lines)
                lines.forEach(element => {
                    if (element != "") {
                        if (element.split(' ')[0] == name)
                            dados.push(element);
                    }
                });

            }
            processa()
            build(dados)

            function build(data) {
                var table = document.getElementById('status')

                console.log(data)
                for (var i = 0; i < data.length; i++) {
                    try {
                        console.log(data[i])
                        var row = `${data[i]}`
                        table.innerHTML += row + "\n"
                        // console.log(data[i].id)
                    } catch {
                        null
                    }
                }
            }
        </script>
        </main>
    </form>

    <script th:src="@{/js/cookies.js}" type="text/javascript"></script>
</body>

</html>